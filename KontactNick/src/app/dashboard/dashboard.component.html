<!-- ‚úÖ –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
<mat-card *ngIf="userProfile" class="fields-card">
  <h2 class="fields-title">üë§ Profile</h2>

  <mat-card-content class="profile-container">
    <!-- ‚úÖ –ê–≤–∞—Ç–∞—Ä -->
    <div class="profile-avatar-container">
      <img *ngIf="userProfile?.avatarUrl; else defaultAvatar"
           [src]="userProfile.avatarUrl"
           alt="User Avatar"
           class="profile-avatar"/>
      <ng-template #defaultAvatar>
        <img src="assets/default-avatar.png" alt="Default Avatar" class="profile-avatar"/>
      </ng-template>
    </div>

    <!-- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ -->
    <div class="profile-info">
      <div>
        <strong>Nick:</strong>
        <span *ngIf="!isEditingNick">{{ userProfile.nick || 'N/A' }}</span>
        <input *ngIf="isEditingNick" [(ngModel)]="editableNick" placeholder="Enter new nick"/>

        <button mat-icon-button color="primary" *ngIf="!isEditingNick" (click)="editNick()">
          <mat-icon>edit</mat-icon>
        </button>

        <button mat-icon-button color="primary" *ngIf="isEditingNick" (click)="saveNick()">
          <mat-icon>check</mat-icon>
        </button>

        <button mat-icon-button color="warn" *ngIf="isEditingNick" (click)="cancelEdit()">
          <mat-icon>close</mat-icon>
        </button>
      </div>

      <div><strong>E-mail:</strong> {{ userProfile.email }}</div>
      <div><strong>Role:</strong> {{ userProfile.role }}</div>

      <div *ngIf="nickError" class="profile-error">
        {{ nickError }}
      </div>
    </div>
  </mat-card-content>
</mat-card>

<!-- ‚úÖ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è -->
<mat-card class="instruction-card">
  <p> ‚ÑπÔ∏è <strong>–ó–¥–µ—Å—å –≤—ã —É–ø—Ä–∞–≤–ª—è–µ—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ –≤–∞—à–∏—Ö –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤.</strong><br>
    –í—ã –º–æ–∂–µ—Ç–µ –ª–µ–≥–∫–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤, –∞ <strong>–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç</strong> –ø–æ–º–æ–∂–µ—Ç –≤–∞–º —Å –∏—Ö –Ω–∞–±–æ—Ä–æ–º
    –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –≤–∞—à–∏–º –≤–æ–∑—Ä–∞—Å—Ç–æ–º, —Ç–µ–º, —á–µ–º –≤—ã –∑–∞–Ω–∏–º–∞–µ—Ç–µ—Å—å, –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —É–∫–ª–∞–¥–æ–º –∏ –¥—Ä—É–≥–∏–º–∏ —Ñ–∞–∫—Ç–æ—Ä–∞–º–∏.<br>
    <strong>–ù–∞–≤–µ–¥–∏—Ç–µ –ø–æ—Ä—è–¥–æ–∫ –≤ —Å–≤–æ–∏—Ö –∫–æ–Ω—Ç–∞–∫—Ç–∞—Ö, –Ω–∞—Å—Ç—Ä–æ–∏–≤ –¥–ª—è –Ω–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–∏!</strong></p>
</mat-card>

<!-- ‚úÖ –ö–Ω–æ–ø–∫–∞ "Add Category" (–≤ —Å—Ç–∏–ª–µ Add Field) -->
<div style="margin: 20px 0; display: flex; justify-content: flex-start;">
  <button class="add-field-btn" (click)="openCategoryDialog()">‚ûï Add Category</button>
</div>

<!-- ‚úÖ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
<mat-card *ngIf="categories && categories.length > 0" class="fields-card">
  <h2 class="fields-title">üìÇ Your Categories</h2>

  <mat-card-content>
    <table class="fields-table">
      <thead>
      <tr>
        <th>
          Category Name
          <button class="sort-btn" (click)="toggleSortOrder()">
            üîÑ
          </button>
        </th>
        <th>Description</th>
        <th>Actions</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let category of sortedCategories">
        <td>{{ category.name }}</td>
        <td>{{ category.description || 'No description' }}</td>
        <td>
          <button class="field-action-btn" (click)="viewCategoryFields(category.id)">üëÄ View</button>
          <button class="field-action-btn" (click)="openCategoryDialog(category)">‚úèÔ∏è Edit</button>
          <button class="field-action-btn" (click)="deleteCategory(category.id)">üóëÔ∏è Delete</button>
        </td>
      </tr>
      </tbody>
    </table>
  </mat-card-content>
</mat-card>

<!-- üî¥ Logout Button -->
<div style="display: flex; justify-content: center; margin-top: 20px;">
  <button mat-stroked-button color="warn" (click)="logout()">üî¥ Logout</button>
</div>
