<!-- âœ… ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ -->
<mat-card *ngIf="userProfile" class="fields-card">
  <h2 class="fields-title">ğŸ‘¤ Profile</h2>

  <mat-card-content class="profile-container">
    <!-- âœ… ĞĞ²Ğ°Ñ‚Ğ°Ñ€ -->
    <div class="profile-avatar-container">
      <img *ngIf="userProfile?.avatarUrl; else defaultAvatar"
           [src]="userProfile.avatarUrl"
           alt="User Avatar"
           class="profile-avatar"/>
      <ng-template #defaultAvatar>
        <img src="assets/default-avatar.png" alt="Default Avatar" class="profile-avatar"/>
      </ng-template>
    </div>

    <!-- âœ… Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğµ -->
    <div class="profile-info">
      <div>
        <strong>Nick:</strong>
        <span *ngIf="!isEditingNick">{{ userProfile.nick || 'N/A' }}</span>
        <input *ngIf="isEditingNick" [(ngModel)]="editableNick" placeholder="Enter new nick"/>

        <button mat-icon-button color="primary" *ngIf="!isEditingNick" (click)="editNick()">
          <mat-icon>edit</mat-icon>
        </button>

        <button mat-icon-button color="primary" *ngIf="isEditingNick" (click)="saveNick()">
          <mat-icon>check</mat-icon>
        </button>

        <button mat-icon-button color="warn" *ngIf="isEditingNick" (click)="cancelEdit()">
          <mat-icon>close</mat-icon>
        </button>
      </div>

      <div><strong>E-mail:</strong> {{ userProfile.email }}</div>
      <div><strong>Role:</strong> {{ userProfile.role }}</div>

      <div *ngIf="nickError" class="profile-error">
        {{ nickError }}
      </div>
    </div>
  </mat-card-content>
</mat-card>

<!-- âœ… ĞšĞ½Ğ¾Ğ¿ĞºĞ° "Add Category" (Ğ² ÑÑ‚Ğ¸Ğ»Ğµ Add Field) -->
<div style="margin: 20px 0; display: flex; justify-content: flex-start;">
  <button class="add-field-btn" (click)="openCategoryDialog()">â• Add Category</button>
</div>

<!-- âœ… ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ -->
<mat-card *ngIf="categories && categories.length > 0" class="fields-card">
  <h2 class="fields-title">ğŸ“‚ Your Categories</h2>

  <mat-card-content>
    <table class="fields-table">
      <thead>
      <tr>
        <th>Category Name</th>
        <th>Description</th>
        <th>Actions</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let category of categories">
        <td>{{ category.name }}</td>
        <td>{{ category.description || 'No description' }}</td>
        <td>
          <button class="field-action-btn" (click)="viewCategoryFields(category.id)">ğŸ‘€ View</button>
          <button class="field-action-btn" (click)="openCategoryDialog(category)">âœï¸ Edit</button>
          <button class="field-action-btn" (click)="deleteCategory(category.id)">ğŸ—‘ï¸ Delete</button>
        </td>
      </tr>
      </tbody>
    </table>
  </mat-card-content>
</mat-card>

<!-- ğŸ”´ Logout Button -->
<div style="display: flex; justify-content: center; margin-top: 20px;">
  <button mat-stroked-button color="warn" (click)="logout()">ğŸ”´ Logout</button>
</div>
